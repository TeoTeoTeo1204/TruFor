CUDNN:
  BENCHMARK: false
  DETERMINISTIC: false
  ENABLED: false
WORKERS: 1

DATASET:
  # TRAIN: [IMD, FR, CA, COCO, RAISE]
  # VALID: [IMD, FR, CA, COCO, RAISE]
  TRAIN: [IMD]
  VALID: [IMD]
  NUM_CLASSES: 2
  CLASS_WEIGHTS: [0.5, 2.5]
MODEL:
  NAME: detconfcmx
  PRETRAINED:
  MODS: ('RGB','NP++')
  EXTRA:
    BACKBONE: mit_b2
    DECODER: MLPDecoder
    DECODER_EMBED_DIM: 512
    PREPRC: "imagenet"
    BN_EPS: 0.001
    BN_MOMENTUM: 0.1
    NP_WEIGHTS:
    MODULES: ["NP++", "backbone", "loc_head", "conf_head", "det_head"]
    # FIX_MODULES: ["NP++", "backbone", "loc_head"]
    FIX_MODULES: ["NP++"]
    DETECTION: "confpool"
LOSS:
  LOSSES:
    - ["LOC", 1.0, "dice_entropy"]
    - ["CONF", 0.5, "mse"]
    - ["DET", 1.0, "cross_entropy"]
  SMOOTH: 0
TRAIN:
  PRETRAINING: "weights/trufor_ph2/best.pth.tar"
  IMAGE_SIZE: [256, 256]
  BATCH_SIZE_PER_GPU: 1
  SHUFFLE: true
  BEGIN_EPOCH: 25
  END_EPOCH: 36
  OPTIMIZER: sgd
  LR: 0.001
  WD: 0.0005
  MOMENTUM: 0.9
  NESTEROV: false
  IGNORE_LABEL: -1
  AUG: "lib/config/aug_res_comp.yaml"
VALID:
  FIRST_VALID: true
  MAX_SIZE: 512
  BEST_KEY: "avg_det_bacc"
  AUG: "lib/config/aug_res_comp.yaml"
